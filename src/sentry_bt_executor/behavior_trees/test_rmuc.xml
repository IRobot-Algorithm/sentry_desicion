<?xml version="1.0"?>
<root main_tree_to_execute="RMUC2024">
  <!-- ///// 此树用于2024分区赛 ///// -->
  <BehaviorTree ID="RMUC2024">
    <Fallback>
      <Sequence>

        <Condition ID="gameStart"/>

        <Fallback>

          <!-- 九、如果需要反前哨站且敌方前哨站存活——到台阶上 如果到台阶了且有目标——打 -->
          <Sequence>
            <Condition ID="counterOutpost"/>
            <!-- <Condition ID="enemyOutpostSurvives"/> -->
            <Fallback>
              <Action ID="SetRmosTarget" service_name="aim_target"
                list_name="OnlyOutpost" 
              />
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
            <Fallback>
              <Sequence>
                <Action ID="RmucGoEnemyOutpost" service_name="nav_goal"/>
                <Condition ID="haveTarget"/>
                <Action ID="SetStaticNavTarget" service_name="nav_target"
                  have_target="{have_target}" 
                  gimbal="{gimbal}" 
                  target_pos="{target_pos}"
                />
              </Sequence>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
          </Sequence>
          <!-- ///////////////// -->


          <!-- 十一、如果有目标且（前哨站幸存或基地展开）—— 动态跟随 如果动态跟随失败——静态跟随-->
          <Sequence>
            <Condition ID="haveTarget"/>
            <Fallback>
              <Condition ID="outpostSurvives"/>
              <Condition ID="baseUnfolds"/>
            </Fallback>
            <Fallback>
              <Action ID="SetNavTarget" service_name="nav_target"
                have_target="{have_target}" 
                gimbal="{gimbal}" 
                target_pos="{target_pos}"
              />
              <Action ID="SetStaticNavTarget" service_name="nav_target"
                have_target="{have_target}" 
                gimbal="{gimbal}" 
                target_pos="{target_pos}"
              />
            </Fallback>
            <Fallback>
              <!-- 敌方前哨站存活——ExceptSentry -->
              <Sequence>
                <Condition ID="enemyOutpostSurvives"/>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="ExceptSentry" 
                />
              </Sequence>
              <!-- 所有 -->
              <Sequence>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="All" 
                />
              </Sequence>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
          </Sequence>
          <!-- ///////////////// -->

          <!-- 十一、如果有目标——停下打 -->
          <Sequence>
            <Condition ID="haveTarget"/>
            <Action ID="SetStaticNavTarget" service_name="nav_target"
              have_target="{have_target}" 
              gimbal="{gimbal}" 
              target_pos="{target_pos}"
            />
            <Fallback>
              <!-- 敌方前哨站存活——ExceptSentry -->
              <Sequence>
                <Condition ID="enemyOutpostSurvives"/>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="ExceptSentry" 
                />
              </Sequence>
              <!-- 所有 -->
              <Sequence>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="All" 
                />
              </Sequence>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
          </Sequence>
          <!-- ///////////////// -->

          <!-- 十二、前哨站幸存——前哨站附近巡逻 -->
          <Sequence>
            <Condition ID="outpostSurvives"/>
            <Fallback>
              <!-- 敌方前哨站存活——ExceptSentry -->
              <Sequence>
                <Condition ID="enemyOutpostSurvives"/>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="ExceptSentry" 
                />
              </Sequence>
              <!-- 所有 -->
              <Sequence>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="All" 
                />
              </Sequence>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
            <Fallback>
              <Action ID="RmucGoOutpost" service_name="nav_goal"/>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
          </Sequence>
          <!-- ///////////////// -->

          <!-- 十三、巡逻 -->
          <Sequence>
            <Fallback>
              <!-- 敌方前哨站存活——ExceptSentry -->
              <Sequence>
                <Condition ID="enemyOutpostSurvives"/>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="ExceptSentry" 
                />
              </Sequence>
              <!-- 所有 -->
              <Sequence>
                <Action ID="SetRmosTarget" service_name="aim_target"
                  list_name="All" 
                />
              </Sequence>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
            <Fallback>
              <Action ID="RmucPatrol" service_name="nav_goal"/>
              <Condition ID="gameStart"/> <!-- TODO : 强制正确 -->
            </Fallback>
          </Sequence>
          <!-- ///////////////// -->
      
        </Fallback>
      
      </Sequence>

    </Fallback>
  </BehaviorTree>

</root>
